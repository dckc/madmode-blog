date: 2006-07-17
title: 'Choosing flight itineraries using tabulator and data from Wikipedia'
published: True
tags: ['breadcrumbs']

<div>  <p>While planning a trip to Boston/Cambridge, I was faced with a <a href="http://www.w3.org/2006/07dc-bos/aa-bos-options.htm">blizzard of itinerary options from American Airlines</a>. I really wanted to overlay them all on the same map or calendar or something. I pretty much got it to work:</p>  <div class="screenshot"> <a href="http://flickr.com/photos/dckc/192169798/"> <img src="http://static.flickr.com/68/192169798_d0eb224a01_o.png" alt="map view" /></a> </div>  <p>That&#39;s a map view using the <a href="/2005/ajar/ajaw/About.html">tabulator</a>, which had another <a href="http://lists.w3.org/Archives/Public/semantic-web/2006Jul/0035.html">release</a> today. The <a href="http://www.w3.org/2006/07dc-bos/aa-bos-options.rdf">itinerary data in RDF</a> is converted from HTML via <a href="http://www.w3.org/2006/07dc-bos/grokOptions.xsl">grokOptions.xsl</a> (and tidy).</p>  <p>I can, in fact, see all the itineraries on the same <a href="http://flickr.com/photos/dckc/192169800/">calendar view</a>. Getting these views to be helpful in choosing between the itineraries is going to take some more work, but this is a start.</p>  <p>Getting a map view required getting latitude/longitude info for the airports. I think getting <a href="/breadcrumbs/node/91">Semantic Web data from Wikipedia</a> is a promising approach.  A while back, I figured out <a href="/breadcrumbs/node/100">how to get lat/long data for airports from wikipedia</a>. This week, I added a <a href="http://kid.lesscode.org/">Kid</a> template, <a href="/2006/data4/aptinfo.kid">aptinfo.kid</a>, and I figured figured out how to serve up that data live from the DIG/CSAIL web server.  For example, <a href="/2006/wikdt/airports?iata=ORD#item">http://dig.csail.mit.edu/2006/wikdt/airports?iata=ORD#item</a> is a URI for the Chicago airport, and when you GET it with HTTP, a little CGI script calls aptdata.py, which fetches the relevant page from wikipedia (using an <a href="http://bitworking.org/projects/httplib2/">httplib2</a> cache) and scrapes the lat/long and a few other details and gives them back to you in RDF. Viewed with RDF/N3 glasses, it looks like:</p>  <pre>#   Base was: http://dig.csail.mit.edu/2006/wikdt/airports?iata=ORD<br />     @prefix : &lt;#&gt; .<br />    @prefix apt: &lt;http://www.daml.org/2001/10/html/airport-ont#&gt; .<br />    @prefix foaf: &lt;http://xmlns.com/foaf/0.1/&gt; .<br />    @prefix geo: &lt;http://www.w3.org/2003/01/geo/wgs84_pos#&gt; .<br />    @prefix go: &lt;http://www.w3.org/2003/01/geo/go#&gt; .<br />    @prefix s: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .<br />    <br />    :item     a apt:Airport;<br />         apt:iataCode &quot;ORD&quot;;<br />         s:comment &quot;tz: -6&quot;;<br />         s:label &quot;O&#39;Hare International Airport&quot;;<br />         go:within_3_power_11_metres :nearbyCity;<br />         geo:lat &quot;41.9794444444&quot;;<br />         geo:long &quot;-87.9044444444&quot;;<br />         foaf:homepage &lt;http://en.wikipedia.org/wiki/O%27Hare_International_Airport&gt; .<br />    <br />    :nearbyCity     foaf:homepage &lt;http://en.wikipedia.org/wiki/wiki/Chicago%2C_Illinois&gt;;<br />         foaf:name &quot;Chicago, Illinois&quot; .<br /></pre>  <p>In particular, notice that:</p>  <ul>  <li>I use the <a href="http://www.w3.org/2003/01/geo/">swig geo vocabulary</a>, which the new <a href="http://www.w3.org/2005/Incubator/geo/">GEO XG</a> is set up to refine. The use of strings rather than datatyped floating point numbers follows the schema for that vocabulary.</li>  <li>I use distinct URIs for the airport  (http://dig.csail.mit.edu/2006/wikdt/airports?iata=ORD#item) and the page about the airport (http://dig.csail.mit.edu/2006/wikdt/airports?iata=ORD).</li>  <li>I use an owl:InverseFunctionalProperty, foaf:homepage to connect the airport to its wikipedia article, and another, apt:iatacode to relate the airport to its IATA code.</li> <li>I use the <a href="http://esw.w3.org/topic/GeoOnion">GeoOnion</a> pattern to relate the airport to a/the city that it serves. I&#39;m not sure I like that pattern, but the idea is to make a browseable web of linked cities, states, countries, and other geographical items.</li> </ul>  <p><em>Hmm... I use rdfs:label for the name of the airport but foaf:name for the name of the city.I don&#39;t think that was a conscious choice. I may change that.</em></p>  <p>The timezone info is in an rdfs:comment. I hope to refine that in future episodes. Stay tuned.</p> </div> 